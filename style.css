/* style.css - Overhauled for Dev Tool Look */

:root {
    /* Color Palette (Inspired by modern dark themes) */
    --bg-deep-dark: #101214;    /* Deepest background */
    --bg-dark: #181a1e;        /* Main content background */
    --bg-medium: #202327;      /* Sidebar, Card backgrounds */
    --bg-light: #2c3138;       /* Hover states, subtle elements */
    --border-color: #353a41;     /* Borders */
    --text-primary: #d1d1d1;   /* Primary text */
    --text-secondary: #9a9fa6; /* Secondary/muted text */
    --text-placeholder: #6a7077;
    --accent-primary: #3e92cc; /* Primary accent (blue) */
    --accent-secondary: #68b3e9; /* Lighter accent / hover */
    --error-color: #e55353;
    --error-bg: rgba(229, 83, 83, 0.1);

    /* Typography */
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --font-size-base: 14px;
    --font-size-small: 12px;
    --font-size-medium: 16px;
    --font-size-large: 18px;
    --line-height-base: 1.6;

    /* Spacing */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;

    /* Borders & Shadows */
    --border-radius: 6px;
    --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);

    /* Transitions */
    --transition-fast: 0.15s ease-out;
    --transition-medium: 0.25s ease-out;

    /* Layout */
    --sidebar-width: 280px;
    --resizer-width: 5px; /* Width of the draggable area */
    --sidebar-min-width: 200px; /* Minimum sidebar width */
    --sidebar-max-width: 600px; /* Maximum sidebar width */
    /* --- NEW: Collapsed state variables --- */
    --sidebar-collapsed-width: 0px; /* Collapsed width */
    --resizer-collapsed-width: 0px; /* Hide resizer when collapsed */
    --reopen-button-width: 30px;
    --reopen-button-offset: 5px; /* How far from the edge */
}

/* Basic Reset */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: var(--font-size-base);
    background-color: var(--bg-deep-dark); /* Set on html for full background */
}

body {
    font-family: var(--font-family);
    color: var(--text-primary);
    line-height: var(--line-height-base);
    height: 100vh; /* Full viewport height */
    overflow: hidden; /* Prevent body scroll */
}

h1, h2, h3, h4, h5, h6 {
    line-height: 1.3;
    font-weight: 500;
}

a {
    color: var(--accent-primary);
    text-decoration: none;
    transition: color var(--transition-fast);
}
a:hover, a:focus {
    color: var(--accent-secondary);
    text-decoration: underline;
}

/* Main Application Layout */
#app-container {
    display: grid;
    grid-template-columns: var(--sidebar-width) var(--resizer-width) 1fr;
    height: 100vh;
    transition: grid-template-columns var(--transition-medium);
    position: relative; /* Needed for absolute positioning of reopen btn */
}

/* Sidebar Styling */
#sidebar {
    /* ... (keep existing sidebar styles) ... */
    background-color: var(--bg-medium);
    border-right: 1px solid var(--border-color);
    padding: var(--spacing-lg) var(--spacing-md);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    overflow-x: hidden;
    height: 100%;
    min-width: var(--sidebar-min-width);
    max-width: var(--sidebar-max-width);
    width: var(--sidebar-width);
    transition: width var(--transition-medium),
                min-width var(--transition-medium),
                padding var(--transition-medium),
                border var(--transition-medium),
                opacity var(--transition-medium);
    opacity: 1;
    z-index: 10; /* Ensure sidebar is above reopen button if needed */
}

#resizer {
    /* ... (keep existing resizer styles) ... */
    grid-column: 2 / 3;
    cursor: col-resize;
    background-color: var(--border-color);
    height: 100%;
    width: var(--resizer-width);
    transition: background-color var(--transition-fast),
                width var(--transition-medium),
                opacity var(--transition-medium);
    opacity: 1;
    user-select: none;
    z-index: 10; /* Ensure resizer is above reopen button */
}
#resizer:hover {
     background-color: var(--accent-secondary);
}

.sidebar-header {
    /* ... (keep existing header styles) ... */
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
}
.sidebar-header h2 { /* Keep */
    font-size: var(--font-size-large);
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
    white-space: nowrap;
}
#sidebar-toggle-btn { /* Keep */
    background: none;
    border: 1px solid transparent;
    color: var(--text-secondary);
    font-size: var(--font-size-large);
    font-weight: bold;
    cursor: pointer;
    padding: 0 var(--spacing-sm);
    line-height: 1;
    border-radius: var(--border-radius);
    transition: background-color var(--transition-fast), color var(--transition-fast);
    margin-left: var(--spacing-md);
    flex-shrink: 0;
}
#sidebar-toggle-btn:hover { /* Keep */
    background-color: var(--bg-light);
    color: var(--text-primary);
}
#sidebar-toggle-btn:focus-visible { /* Keep */
    outline: 2px solid var(--accent-primary);
    outline-offset: 1px;
}

/* --- NEW: Reopen Button Styles --- */
#sidebar-reopen-btn {
    position: absolute; /* Position relative to app-container */
    top: var(--spacing-md); /* Align near top */
    left: var(--reopen-button-offset);
    width: var(--reopen-button-width);
    height: var(--reopen-button-width);
    background-color: var(--bg-light);
    border: 1px solid var(--border-color);
    color: var(--text-secondary);
    font-size: var(--font-size-large);
    font-weight: bold;
    cursor: pointer;
    border-radius: 50%; /* Make it round */
    display: none; /* Hidden by default */
    place-items: center; /* Center the icon */
    z-index: 20; /* Ensure it's above other elements */
    opacity: 0.8;
    transition: background-color var(--transition-fast),
                color var(--transition-fast),
                opacity var(--transition-medium),
                transform var(--transition-medium);
}

#sidebar-reopen-btn:hover {
    background-color: hsl(from var(--bg-light) h s calc(l + 8%));
    color: var(--text-primary);
    opacity: 1;
}

#sidebar-reopen-btn:focus-visible {
    outline: 2px solid var(--accent-primary);
    outline-offset: 1px;
}

/* Bulk Run Selection Controls */
#run-bulk-controls {
    display: flex;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md); /* Space before the list */
    flex-shrink: 0; /* Prevent shrinking */
}

.bulk-action-btn {
    flex-grow: 1; /* Make buttons share space */
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: var(--font-size-small);
    background-color: var(--bg-light);
    border: 1px solid var(--border-color);
    color: var(--text-secondary);
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background-color var(--transition-fast), color var(--transition-fast);
    text-align: center;
}
.bulk-action-btn:hover {
    background-color: hsl(from var(--bg-light) h s calc(l + 5%));
    color: var(--text-primary);
}
.bulk-action-btn:active {
    background-color: hsl(from var(--bg-light) h s calc(l - 5%));
}
.bulk-action-btn:focus-visible {
    outline: 2px solid var(--accent-primary);
    outline-offset: 1px;
}

/* --- NEW: Styles for Collapsed State --- */

#app-container.sidebar-collapsed {
    grid-template-columns: var(--sidebar-collapsed-width) var(--resizer-collapsed-width) 1fr;
}

#app-container.sidebar-collapsed #sidebar {
    width: var(--sidebar-collapsed-width);
    min-width: var(--sidebar-collapsed-width);
    padding-left: 0;
    padding-right: 0;
    border-right-width: 0;
    opacity: 0;
    overflow: hidden;
    /* Make sure the original toggle button is not clickable when hidden */
    pointer-events: none;
}

#app-container.sidebar-collapsed #resizer {
    width: var(--resizer-collapsed-width);
    opacity: 0;
    cursor: default;
    pointer-events: none; /* Not interactive when hidden */
}

/* --- NEW: Show Reopen Button when Collapsed --- */
#app-container.sidebar-collapsed #sidebar-reopen-btn {
    display: grid; /* Use grid to center content */
}


#controls-container { flex-grow: 1; display: flex; flex-direction: column; min-height: 0; }
#controls-container h3 { font-size: var(--font-size-medium); color: var(--text-secondary); margin-bottom: var(--spacing-md); font-weight: 600; }
#run-bulk-controls { display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-md); flex-shrink: 0; }
.bulk-action-btn { flex-grow: 1; padding: var(--spacing-xs) var(--spacing-sm); font-size: var(--font-size-small); background-color: var(--bg-light); border: 1px solid var(--border-color); color: var(--text-secondary); border-radius: var(--border-radius); cursor: pointer; transition: background-color var(--transition-fast), color var(--transition-fast); text-align: center; }
.bulk-action-btn:hover { background-color: hsl(from var(--bg-light) h s calc(l + 5%)); color: var(--text-primary); }
.bulk-action-btn:active { background-color: hsl(from var(--bg-light) h s calc(l - 5%)); }
.bulk-action-btn:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 1px; }
#run-selector { flex-grow: 1; overflow-y: auto; border: 1px solid var(--border-color); background-color: var(--bg-dark); border-radius: var(--border-radius); padding: var(--spacing-sm); margin-bottom: var(--spacing-md); min-height: 150px; }
#run-selector p { color: var(--text-placeholder); padding: var(--spacing-md); text-align: center; }
.run-checkbox-item { display: flex; align-items: center; padding: var(--spacing-sm) var(--spacing-md); border-radius: calc(var(--border-radius) / 1.5); margin-bottom: var(--spacing-xs); transition: background-color var(--transition-fast); cursor: pointer; }
.run-checkbox-item:hover { background-color: var(--bg-light); }
.run-checkbox-item label { margin-left: var(--spacing-sm); cursor: pointer; display: inline-flex; align-items: center; flex-grow: 1; color: var(--text-primary); font-size: var(--font-size-base); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.run-checkbox-item input[type="checkbox"] { margin: 0; cursor: pointer; accent-color: var(--accent-primary); width: 16px; height: 16px; flex-shrink: 0; background-color: var(--bg-dark); border: 1px solid var(--border-color); border-radius: 3px; appearance: none; display: grid; place-content: center; }
.run-checkbox-item input[type="checkbox"]::before { content: ""; width: 0.65em; height: 0.65em; transform: scale(0); transition: 120ms transform ease-in-out; box-shadow: inset 1em 1em var(--accent-primary); clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%); }
.run-checkbox-item input[type="checkbox"]:checked::before { transform: scale(1); }
.run-checkbox-item input[type="checkbox"]:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 2px; }
.color-swatch { display: inline-block; width: 12px; height: 12px; border: 1px solid var(--border-color); margin-right: var(--spacing-sm); flex-shrink: 0; border-radius: 3px; }
#loading-indicator { font-size: var(--font-size-small); color: var(--text-secondary); margin-top: var(--spacing-sm); display: flex; align-items: center; padding: 0 var(--spacing-md); }
#loading-indicator::before { content: ''; display: inline-block; width: 0.9em; height: 0.9em; border: 2px solid currentColor; border-right-color: transparent; border-radius: 50%; animation: spinner 0.75s linear infinite; margin-right: var(--spacing-sm); }
@keyframes spinner { to { transform: rotate(360deg); } }
#error-message { font-size: var(--font-size-small); color: var(--error-color); background-color: var(--error-bg); border: 1px solid var(--error-color); padding: var(--spacing-sm) var(--spacing-md); border-radius: var(--border-radius); margin-top: var(--spacing-md); }


/* Sidebar Footer */
.sidebar-footer { margin-top: var(--spacing-lg); padding-top: var(--spacing-md); border-top: 1px solid var(--border-color); font-size: var(--font-size-small); color: var(--text-secondary); flex-shrink: 0; }
.sidebar-footer p { font-weight: 600; margin-bottom: var(--spacing-sm); }
.sidebar-footer ul { list-style: none; padding-left: 0; }
.sidebar-footer li { margin-bottom: var(--spacing-xs); }
.sidebar-footer kbd { display: inline-block; padding: 2px 6px; font-family: monospace; font-size: 0.9em; color: var(--text-primary); background-color: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; box-shadow: inset 0 -1px 0 var(--border-color); margin: 0 2px; }


/* Main Content Area Styling */
#main-content {
    background-color: var(--bg-dark);
    padding: var(--spacing-lg);
    overflow-y: auto;
    height: 100%;
    grid-column: 3 / 4;
    /* Add padding-left to avoid content potentially going under the reopen button */
    /* Adjust value based on button width and offset */
    /* padding-left: calc(var(--reopen-button-width) + var(--reopen-button-offset) * 2); */
    /* Alternatively, rely on the button's z-index */
}

/* Dashboard Grid */
#dashboard-container { display: flex; flex-direction: column; gap: var(--spacing-lg); }
.metric-group { background-color: var(--bg-medium); border: 1px solid var(--border-color); border-radius: var(--border-radius); overflow: hidden; }
.metric-group-header { display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-sm) var(--spacing-md); background-color: var(--bg-light); border-bottom: 1px solid var(--border-color); cursor: pointer; transition: background-color var(--transition-fast); }
.metric-group-header:hover { background-color: hsl(from var(--bg-light) h s calc(l + 5%)); }
.metric-group-header h3 { font-size: var(--font-size-medium); font-weight: 600; color: var(--text-primary); margin: 0; flex-grow: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.toggle-button { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1.2em; padding: 0 var(--spacing-sm); line-height: 1; transition: transform var(--transition-fast); flex-shrink: 0; }
.toggle-button::before { content: '−'; display: inline-block; width: 1em; text-align: center; }
.metric-group.collapsed .toggle-button::before { content: '+'; }
.toggle-button:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 1px; border-radius: 3px; }
.metric-group-plots { display: grid; grid-template-columns: repeat(auto-fit, minmax(min(400px, 100%), 1fr)); gap: var(--spacing-lg); padding: var(--spacing-lg); }
.metric-group.collapsed .metric-group-plots { display: none; }
.metric-group-plots .plot-wrapper { margin-bottom: 0; }
.placeholder-text { color: var(--text-placeholder); text-align: center; font-size: var(--font-size-medium); padding: var(--spacing-xl); background-color: var(--bg-medium); border: 1px dashed var(--border-color); border-radius: var(--border-radius); margin: auto; max-width: 600px; }

/* Plot Wrapper Styling */
.plot-wrapper { background-color: var(--bg-medium); border: 1px solid var(--border-color); border-radius: var(--border-radius); box-shadow: var(--box-shadow); display: flex; flex-direction: column; min-height: 350px; overflow: hidden; }
.plot-wrapper h3 { font-size: var(--font-size-base); font-weight: 500; color: var(--text-secondary); padding: var(--spacing-sm) var(--spacing-md); margin: 0; border-bottom: 1px solid var(--border-color); background-color: var(--bg-medium); text-align: left; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.plot-canvas { width: 100%; flex-grow: 1; display: block; background-color: var(--bg-medium); cursor: grab; min-height: 250px; }
.plot-canvas:active { cursor: grabbing; }
.plot-canvas[style*="cursor: crosshair"] { cursor: crosshair !important; }
.plot-canvas[style*="cursor: grabbing"] { cursor: grabbing !important; }

/* Info Footer in Main Content */
.info { margin-top: var(--spacing-xl); text-align: center; font-size: var(--font-size-small); color: var(--text-secondary); padding-bottom: var(--spacing-md); }
.info p { margin-bottom: var(--spacing-xs); }

/* Scrollbar Styling (Webkit - Chrome, Safari, Edge) */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--bg-dark); border-radius: 5px; }
::-webkit-scrollbar-thumb { background-color: var(--border-color); border-radius: 5px; border: 2px solid var(--bg-dark); }
::-webkit-scrollbar-thumb:hover { background-color: var(--text-secondary); }
#sidebar::-webkit-scrollbar-track { background: var(--bg-medium); }
#sidebar::-webkit-scrollbar-thumb { border: 2px solid var(--bg-medium); }
#run-selector::-webkit-scrollbar-track { background: var(--bg-dark); }
#run-selector::-webkit-scrollbar-thumb { border: 2px solid var(--bg-dark); }
